/**
* @license
* backbone-request 99xp
* ----------------------------------
* v1.0.0
*
* Copyright (c)2020 Bruno Foggia, 99xp.
* Distributed under MIT license
*
* https://backbone-request.99xp.org
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("backbone"),require("underscore-99xp"),require("axios")):"function"==typeof define&&define.amd?define(["exports","backbone","underscore-99xp","axios"],t):t((e=e||self).BackboneRequest={},e.Backbone,e._,e.axios)}(this,function(e,t,a,r){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,a=a&&a.hasOwnProperty("default")?a.default:a,r=r&&r.hasOwnProperty("default")?r.default:r,a.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{\%(.+?)\%\}/g,escape:/\{-([\s\S]+?)-\}/g};var s=a.clone(t);s.VERSION="0.1.0",s.emulateHTTP=!1,s.emulateJSON=!1,s.sync=function(e,t,r){var u=n[e];a.defaults(r||(r={}),{emulateHTTP:s.emulateHTTP,emulateJSON:s.emulateJSON,headers:{}});var o=a.extend({},r,{type:u,dataType:"json"});r.url||(o.url=a.result(t,"url")||s.urlError()),null!=r.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||t.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),!r.emulateHTTP||"PUT"!==u&&"DELETE"!==u&&"PATCH"!==u||(o.type="POST",r.emulateJSON&&(o.data._method=u),o.headers["X-HTTP-Method-Override"]=u),"GET"===o.type||r.emulateJSON||(o.processData=!1);var l=a.extend({url:o.url,method:o.type,headers:o.headers},a.pick(o,"data"),a.omit(r,"type","dataType","emulateHTTP","emulateJSON"));return l.headers["content-type"]=o.contentType||"application/json",l.then=a.partial((e,t,a)=>{"function"==typeof t.success&&t.success(a.data)},this,r),l.catch=a.bind(a.partial((e,t,a)=>{this._reqErr=a,"function"==typeof t.error&&t.error(a)},this,r),this),s.exec(l)},s.exec=function(e,t=null,s=null){if("string"!=typeof e.url||!s&&a.size(a.pick(e,"then","catch"))<2)return!1;var n=a.defaults(a.pick(e,"url","method","headers","data"),{method:"GET",headers:{}});return"function"!=typeof e.then&&(e.then=((e,t,a)=>{a.status(e.status).send(e.data)})),"function"!=typeof e.finally&&(e.finally=(()=>{})),"function"!=typeof e.catch&&(e.catch=((e,t,a)=>{try{var r=e.response.data;if("object"!=typeof r)try{r=JSON.parse(r)}catch(e){r={message:r}}a.status(e.response.status).send(JSON.stringify(r))}catch(e){a.status(500).send(JSON.stringify({message:"Internal Failure"}))}})),r(n).then(a.partial((t,a,r,s)=>e.then(s,t,a),t,s,e)).catch(a.partial((t,a,r,s)=>e.catch(s,t,a),t,s,e)).finally(a.partial((t,a,r)=>e.finally(t,a),t,s,e))};var n={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};s.urlError=function(){throw new Error('A "url" property or function must be specified')},a.map(["Events"],e=>s[e]=a.clone(t[e])),a.map(["Model","Collection"],e=>s[e]=t[e].extend({initialize(e={},t={}){this.setRouterParameters(t.req,t.res)},setRouterParameters(e=null,t=null){this._req=e,this._res=t},sync(){return s.sync.apply(this,arguments)},fetchp(e,t={}){return t.success=e,this.fetch(t)},savep(e,t={}){return t.success=e,this.save(null,t)},destroyp(e,t={}){return t.success=e,this.destroy(t)}})),e.default=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=backbone-request-99xp.min.js.map
